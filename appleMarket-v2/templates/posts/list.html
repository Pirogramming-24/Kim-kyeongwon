{% extends 'base.html' %}
{% load static %}

{% block head %}
<title>post_list</title>
<style>
    .hashtag-filter {
        padding: 10px;
        background-color: #e8f5e9;
        border-left: 4px solid #28a745;
        margin-bottom: 15px;
    }
    .hashtag-display {
        display: inline-block;
        padding: 3px 10px;
        background-color: #28a745;
        color: white;
        border-radius: 12px;
        font-size: 13px;
        margin-right: 5px;
    }
</style>
{% endblock %}

{% block content %}
<div class="search-box">
    <form action="/">
        <input class='form-control' type="input" name="search_txt" placeholder="검색어를 입력하세요"
            value="{{ search_txt|default:'' }}" />
        <input class='form-control' type="text" name="min_price" placeholder="최소 가격"
            value="{{ min_price|default:'' }}" />
        <input class='form-control mx-2' type="text" name="max_price" placeholder="최대 가격"
            value="{{ max_price|default:'' }}" />
        <input class='btn btn-outline-success mx-2' type="submit" value="검색" />
    </form>
    <a href="{% url 'posts:create' %}" class='btn btn-secondary'>글 생성하러 가기</a>
</div>

<div class="content-wrapper">
    {% if request.GET.hashtag %}
    <div class="hashtag-filter">
        <span class="hashtag-display">{{ request.GET.hashtag }}</span> 검색 결과입니다. 
        <a href="/" style="margin-left: 10px;">전체 보기</a>
    </div>
    {% endif %}
    
    <hr />
    <!-- 동적으로 렌더링되는 post 리스트 -->
    {% for post in posts %}
    <div class="item">
        {% if post.photo %}
        <img src="{{ post.photo.url }}" alt="업로드 이미지" />
        {% else %}
        <img src="{% static 'posts/image/noimage.jpg' %}" alt="기본 이미지" />
        {% endif %}
        <div class="info">
            <a class="title" href="{% url 'posts:detail' post.pk %}">{{post.title}}</a>
            <p class="region">지역: {{post.region}}</p>
            <p class="price">가격: {{post.price}}</p>
            <p class="create-date">작성일: {{post.created_at}}</p>
            {% if post.hashtags %}
            <p style="font-size: 12px; color: #666;">{{post.hashtags}}</p>
            {% endif %}
        </div>
    </div>
    <hr />
    {% endfor %}
</div>
{% endblock %}